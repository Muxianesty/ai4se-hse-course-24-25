# Практическое задание на тему "Генерация имени функции по ее телу"

Выполнил: Литвинов Михаил Юрьевич, группа МСТПР241.

## Подготовка окружения

Как и было предложено, работа с проектом происходит посредством развертывания отдельного venv-окружения:

```shell
python3 -m venv venv
```

Установка всех зависимостей производится:

```
venv/Scripts/python -m pip install -r requirements.txt
venv/Scripts/python -m pip install -r requirements_dev.txt
```

## Подзадача 1: Подготовка набора данных

См. файл `funccraft/data.py` (и файл `funccraft/<lang>_funccraft.py` для нужного языка).

Подготовка набора данных производилась на первых `1000` элементах из выборки `test` из `code-search-net/code_search_net` для ЯП Python.
Для каждого элемента набора данных добавлялось три поля - `NEW_func_name`, `NEW_whole_func_string`, `NEW_docs_func_string`: извлеченные с помощью `tree_sitter` имя функции, ее тело с и без документирующих комментариев. Примеры обработки приведены для нескольких элементов с индексами `9`, `19`, `21`, `62` в файле `prepared-dataset/9-19-21-62.json`. Для определения того, является ли узел в AST комментарием, проверяется соответствие типа узла значению `comment` или значению `expression_statement` - во втором случае проверяется, содержит ли узел подстроку `"""` или `'''` (для Python - см. функцию `isComment` в `funccraft/python_funccraft.py`) с возможным префиксом `r`. 

Подготовка набора данных производится следующим образом:

```
venv/Scripts/python.exe main.py prepare-data
```

## Подзадача 2: Использование предобученных моделей для предсказания имен функций

Для предсказаний используется предобученная модель [**CodeT5+**](https://huggingface.co/Salesforce/codet5p-220m), где для предсказания только лишь имени функции к ее телу добавляется префикс `" def <extra_id_0> ():\n    "`.

### Использование исходного кода БЕЗ комментариев для предсказания имен функций

Предсказание производится следующим образом:

```
venv/Scripts/python.exe main.py predict-names
```

По результатам нескольких запусков в среднем были получены следующие результаты:

```
********************************************************************************
Evaluation results:
{'exact_match': np.float64(0.026),
 'rouge1': np.float64(0.32973804528804534),
 'rouge2': np.float64(0.14731601731601746),
 'rougeL': np.float64(0.32856615606615636),
 'rougeLsum': np.float64(0.3284613580863587)}
********************************************************************************
```

### Использование исходного кода и комментариев к нему для предсказания имен функций

Предсказание производится следующим образом:

```
venv/Scripts/python.exe main.py predict-names --full
```

По результатам нескольких запусков в среднем были получены следующие результаты:

```
********************************************************************************
Evaluation results:
{'exact_match': np.float64(0.053),
 'rouge1': np.float64(0.4103563353313357),
 'rouge2': np.float64(0.22459931457431465),
 'rougeL': np.float64(0.4085352675102679),
 'rougeLsum': np.float64(0.40822476412476427)}
********************************************************************************
```
